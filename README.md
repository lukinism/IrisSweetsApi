# üç¨ Iris Sweets API

**PHP –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Iris Sweets API**

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–æ–ª–¥–æ–π** - –≤—ã–¥–∞—á–∞, –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Ä–∏—Å–∫–∞–º–∏** - –≤—ã–¥–∞—á–∞, –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π  
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ—à–∫–æ–º** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–µ—Ç–∞ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –≤–∞–º –∏ —Å–º–æ—Ç—Ä–µ—Ç—å –≤–∞—à –º–µ—à–æ–∫.
- **–ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞–ª–∞–Ω—Å–µ

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/lukinism/IrisSweetsApi.git
cd IrisSweetsLibrary

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
composer install
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ —Ñ–∞–π–ª .env (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —à–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
```bash
cp env.example .env
```

2. **–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `.env`:**
```env
# ID –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
IRIS_BOT_ID=your_bot_id_here

# –¢–æ–∫–µ–Ω
IRIS_TOKEN=your_iris_token_here
```

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞

```php
$api = new IrisSweets($botId, $irisToken);
```

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

```php
<?php
require_once __DIR__ . '/vendor/autoload.php';

use IrisSweetsApi\IrisSweets;
use IrisSweetsApi\Exception\ApiException;

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ .env
$api = new IrisSweets();

// –ò–ª–∏ –ø–µ—Ä–µ–¥–∞–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞–ø—Ä—è–º—É—é
$api = new IrisSweets('your-bot-id', 'your-iris-token');
```

### üí∞ –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞

```php
try {
    $balance = $api->balance()->getBalance();
    echo "–ì–æ–ª–¥: " . $balance['gold'] . "\n";
    echo "–ò—Ä–∏—Å–∫–∏: " . $balance['sweets'] . "\n";
    echo "–î–æ–Ω–∞—Ç –æ—á–∫–∏: " . $balance['donate_score'] . "\n";
} catch (ApiException $e) {
    echo "–û—à–∏–±–∫–∞ API: " . $e->getMessage() . "\n";
}
```

### üç¨ –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –∏—Ä–∏—Å–∫–∞–º–∏

```php
try {
    // –í—ã–¥–∞—Ç—å 10 –∏—Ä–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    $result = $api->sweets()->give(10, 123456);
    echo "‚úÖ –ò—Ä–∏—Å–∫–∏ —É—Å–ø–µ—à–Ω–æ –≤—ã–¥–∞–Ω—ã\n";
    
    // –í—ã–¥–∞—Ç—å 5.5 –∏—Ä–∏—Å–æ–∫ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º
    $result = $api->sweets()->give(5.5, 123456, '–ù–∞–≥—Ä–∞–¥–∞ –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å');
    echo "‚úÖ –ò—Ä–∏—Å–∫–∏ —É—Å–ø–µ—à–Ω–æ –≤—ã–¥–∞–Ω—ã\n";
    
    // –ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –æ–ø–µ—Ä–∞—Ü–∏–π
    $history = $api->sweets()->getHistory(0);
    echo "–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π: " . count($history) . " –∑–∞–ø–∏—Å–µ–π\n";
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
    foreach ($history as $transaction) {
        echo "ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: " . $transaction['id'] . "\n";
        echo "–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏: " . $transaction['type'] . "\n";
        echo "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: " . $transaction['amount'] . "\n";
        echo "–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç: " . $transaction['peer_id'] . "\n";
        echo "–ë–∞–ª–∞–Ω—Å: " . $transaction['balance'] . "\n";
        echo "–î–∞—Ç–∞: " . date('Y-m-d H:i:s', $transaction['date'] / 1000) . "\n";
        
        if (isset($transaction['details']['fee'])) {
            echo "–ö–æ–º–∏—Å—Å–∏—è: " . $transaction['details']['fee'] . "\n";
        }
        
        if (isset($transaction['details']['total'])) {
            echo "–û–±—â–∞—è —Å—É–º–º–∞: " . $transaction['details']['total'] . "\n";
        }
        
        if (isset($transaction['details']['amount'])) {
            echo "–ü–æ–ª—É—á–µ–Ω–æ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–º: " . $transaction['details']['amount'] . "\n";
        }
        
        if (isset($transaction['details']['donate_score'])) {
            echo "–î–æ–Ω–∞—Ç –æ—á–∫–∏: " . $transaction['details']['donate_score'] . "\n";
        }
        
        if (isset($transaction['comment']) && !empty($transaction['comment'])) {
            echo "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: " . $transaction['comment'] . "\n";
        }
        
        if (isset($transaction['metadata']) && !empty($transaction['metadata'])) {
            echo "–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ: " . json_encode($transaction['metadata']) . "\n";
        }
        
        echo "---\n";
    }
    
} catch (ApiException $e) {
    echo "‚ùå –û—à–∏–±–∫–∞ API: " . $e->getMessage() . "\n";
}
```

### ü™ô –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –≥–æ–ª–¥–æ–π

```php
try {
    // –í—ã–¥–∞—Ç—å 100 –≥–æ–ª–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    $result = $api->gold()->give(100, 123456);
    echo "‚úÖ –ì–æ–ª–¥–∞ —É—Å–ø–µ—à–Ω–∞ –≤—ã–¥–∞–Ω–∞\n";
    
    // –í—ã–¥–∞—Ç—å 50.5 –≥–æ–ª–¥—ã —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º
    $result = $api->gold()->give(50.5, 123456, '–ù–∞–≥—Ä–∞–¥–∞ –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å');
    echo "‚úÖ –ì–æ–ª–¥–∞ —É—Å–ø–µ—à–Ω–∞ –≤—ã–¥–∞–Ω–∞\n";
    
    // –ü–æ–ª—É—á–∏—Ç—å –æ–±—â—É—é –∏—Å—Ç–æ—Ä–∏—é –æ–ø–µ—Ä–∞—Ü–∏–π
    $history = $api->gold()->getHistory(0);
    echo "–û–±—â–∞—è –∏—Å—Ç–æ—Ä–∏—è: " . count($history) . " –∑–∞–ø–∏—Å–µ–π\n";
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≥–æ–ª–¥—ã
    foreach ($history as $transaction) {
        echo "ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: " . $transaction['id'] . "\n";
        echo "–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏: " . $transaction['type'] . "\n";
        echo "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: " . $transaction['amount'] . "\n";
        echo "–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç: " . $transaction['peer_id'] . "\n";
        echo "–ë–∞–ª–∞–Ω—Å: " . $transaction['balance'] . "\n";
        echo "–î–∞—Ç–∞: " . date('Y-m-d H:i:s', $transaction['date'] / 1000) . "\n";
        
        if (isset($transaction['details']['fee'])) {
            echo "–ö–æ–º–∏—Å—Å–∏—è: " . $transaction['details']['fee'] . "\n";
        }
        
        if (isset($transaction['details']['total'])) {
            echo "–û–±—â–∞—è —Å—É–º–º–∞, –≤–∫–ª—é—á–∞—è –∫–æ–º–∏—Å—Å–∏—é: " . $transaction['details']['total'] . "\n";
        }
        
        if (isset($transaction['details']['amount'])) {
            echo "–ü–æ–ª—É—á–µ–Ω–æ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–º: " . $transaction['details']['amount'] . "\n";
        }
        
        if (isset($transaction['details']['donate_score'])) {
            echo "–î–æ–Ω–∞—Ç –æ—á–∫–∏: " . $transaction['details']['donate_score'] . "\n";
        }
        
        if (isset($transaction['comment']) && !empty($transaction['comment'])) {
            echo "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: " . $transaction['comment'] . "\n";
        }
        
        if (isset($transaction['metadata']) && !empty($transaction['metadata'])) {
            echo "–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ: " . json_encode($transaction['metadata']) . "\n";
        }
        
        echo "---\n";
    }
    
} catch (ApiException $e) {
    echo "‚ùå –û—à–∏–±–∫–∞ API: " . $e->getMessage() . "\n";
}
```

### üëú –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ—à–∫–æ–º

```php
try {
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –∫ –º–µ—à–∫—É
    $api->pocket()->enable();      // –û—Ç–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø
    $api->pocket()->disable();     // –ó–∞–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø
    
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—â–∏–º–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏ –Ω–∞ –ø–µ—Ä–µ–≤–æ–¥—ã
    $api->pocket()->allow_all();   // –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Å–µ–º –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å
    $api->pocket()->deny_all();    // –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –≤—Å–µ–º –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å
    
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
    $api->pocket()->allow_user(123456);  // –†–∞–∑—Ä–µ—à–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    $api->pocket()->deny_user(123456);   // –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    
    echo "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–µ—à–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω—ã\n";
    
} catch (ApiException $e) {
    echo "‚ùå –û—à–∏–±–∫–∞ API: " . $e->getMessage() . "\n";
}
```

### üîÑ –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å–æ–±—ã—Ç–∏–π

```php
try {
    // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å–æ–±—ã—Ç–∏—è
    $updates = $api->updates()->getUpdates();
    echo "–°–æ–±—ã—Ç–∏—è: " . count($updates) . " –∑–∞–ø–∏—Å–µ–π\n";
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
    foreach ($updates as $update) {
        echo "ID —Å–æ–±—ã—Ç–∏—è: " . $update['id'] . "\n";
        echo "–¢–∏–ø —Å–æ–±—ã—Ç–∏—è: " . $update['type'] . "\n";
        echo "–î–∞—Ç–∞: " . date('Y-m-d H:i:s', $update['date']) . "\n";
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—ä–µ–∫—Ç–∞ —Å–æ–±—ã—Ç–∏—è
        $object = $update['object'];
        if ($update['type'] === 'sweets_log') {
            echo "–ò—Ä–∏—Å–∫–∏: " . $object['amount'] . "\n";
            echo "–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç: " . $object['peer_id'] . "\n";
        } elseif ($update['type'] === 'gold_log') {
            echo "–ì–æ–ª–¥–∞: " . $object['amount'] . "\n";
            echo "–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç: " . $object['peer_id'] . "\n";
        }
        
        echo "---\n";
    }
    
    // –ü–æ–ª—É—á–∏—Ç—å —Å–æ–±—ã—Ç–∏—è —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ ID
    $updates = $api->updates()->getUpdates(10);
    
} catch (ApiException $e) {
    echo "‚ùå –û—à–∏–±–∫–∞ API: " . $e->getMessage() . "\n";
}
```

### ü§ñ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤ –ò—Ä–∏—Å–∞

```php
try {
    // –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤
    $agents = $api->irisAgents()->getAgents();
    echo "–î–µ–π—Å—Ç–≤—É—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤: " . count($agents) . "\n";
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–∏—Å–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤
    foreach ($agents as $agentId) {
        echo "ID –∞–≥–µ–Ω—Ç–∞: " . $agentId . "\n";
    }
    
} catch (ApiException $e) {
    echo "‚ùå –û—à–∏–±–∫–∞ API: " . $e->getMessage() . "\n";
}
```

## üìö API –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫

### –ë–∞–ª–∞–Ω—Å
- `balance()->getBalance()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞

### –ò—Ä–∏—Å–∫–∏
- `sweets()->give($sweets, $userId, $comment)` - –≤—ã–¥–∞—á–∞ –∏—Ä–∏—Å–æ–∫
  - `$sweets` (int|float) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ä–∏—Å–æ–∫
  - `$userId` (int) - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `$comment` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –≤—ã–¥–∞—á–µ
- `sweets()->getHistory($offset)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
  - `$offset` (int) - ID –∑–∞–ø–∏—Å–∏ –¥–ª—è —Å–º–µ—â–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0)

### –ì–æ–ª–¥–∞
- `gold()->give($gold, $userId, $comment)` - –≤—ã–¥–∞—á–∞ –≥–æ–ª–¥—ã
  - `$gold` (int|float) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–¥—ã
  - `$userId` (int) - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `$comment` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –≤—ã–¥–∞—á–µ
- `gold()->getHistory($offset)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–±—â–µ–π –∏—Å—Ç–æ—Ä–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ—à–∫–æ–º
- `pocket()->enable()` - –æ—Ç–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø –∫ –º–µ—à–∫—É
- `pocket()->disable()` - –∑–∞–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø –∫ –º–µ—à–∫—É
- `pocket()->allow_all()` - —Ä–∞–∑—Ä–µ—à–∏—Ç—å –≤—Å–µ–º –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –≤ –º–µ—à–æ–∫
- `pocket()->deny_all()` - –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –≤—Å–µ–º –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –≤ –º–µ—à–æ–∫
- `pocket()->allow_user($userId)` - —Ä–∞–∑—Ä–µ—à–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- `pocket()->deny_user($userId)` - –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### –û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
- `updates()->getUpdates($offset)` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
  - `$offset` (int) - ID —Å–æ–±—ã—Ç–∏—è –¥–ª—è —Å–º–µ—â–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0)

### –ê–≥–µ–Ω—Ç—ã –ò—Ä–∏—Å–∞
- `irisAgents()->getAgents()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤

## ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Å `ApiException` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ API.

### –¢–∏–ø—ã –æ—à–∏–±–æ–∫

- **ApiException** - –æ—à–∏–±–∫–∏ –æ—Ç API (–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –≤–∞–ª—é—Ç—ã, –ø—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏ —Ç.–¥.)
- **Exception** - –æ–±—â–∏–µ –æ—à–∏–±–∫–∏ (—Å–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)

### –ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫

```json
{
    "error": {
        "code": 0,
        "description": "Not enough gold. Need 1"
    }
}
```

```json
{
    "error": {
        "code": 1,
        "description": "User not found"
    }
}
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–æ—â–Ω—É—é —Å–∏—Å—Ç–µ–º—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏ –∏ –¥–µ—Ç–∞–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

#### –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä

```php
try {
    $api->gold()->give(100, 123456);
} catch (ApiException $e) {
    echo "–û—à–∏–±–∫–∞ API: " . $e->getMessage() . "\n";
    echo "–ö–æ–¥ –æ—à–∏–±–∫–∏: " . $e->getErrorCode() . "\n";
    echo "–û–ø–∏—Å–∞–Ω–∏–µ: " . $e->getErrorDescription() . "\n";
} catch (Exception $e) {
    echo "–û–±—â–∞—è –æ—à–∏–±–∫–∞: " . $e->getMessage() . "\n";
}
```

#### –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```php
use IrisSweetsApi\Exception\ErrorHandler;

try {
    $api->sweets()->give(10, 123456);
} catch (ApiException $e) {
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    $message = ErrorHandler::handle($e);
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –æ—à–∏–±–∫–∏
    if ($e->isRetryable()) {
        echo "–í—Ä–µ–º–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ\n";
        echo "–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞: " . $e->getRetryDelay() . " —Å–µ–∫\n";
    }
    
    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    echo "–û—à–∏–±–∫–∞: " . $e->getUserFriendlyMessage() . "\n";
    
    // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é
    $recommendations = ErrorHandler::getRecommendations($e);
    foreach ($recommendations as $rec) {
        echo "- " . $rec . "\n";
    }
}
```

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏

```php
// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ API
$api->sweets()->setRetrySettings(3, 2, 1.5); // 3 –ø–æ–ø—ã—Ç–∫–∏, –±–∞–∑–æ–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ 2—Å

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ (HTTP 500, 409)
```

#### –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏

```php
// –í–∫–ª—é—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
define('IRIS_DEBUG', true);
$api->sweets()->enableDebug();

// –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—à–∏–±–∫–µ
$detailedInfo = $e->getDetailedInfo();
print_r($detailedInfo);
```

**üìö –ü–æ–¥—Ä–æ–±–Ω–µ–µ:** –°–º. [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—à–∏–±–æ–∫](docs/ERROR_HANDLING.md)

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö API

### –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (getHistory)

```php
[
    [
        'id' => int,                    // ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
        'type' => string,               // 'send' –∏–ª–∏ 'receive'
        'amount' => float,              // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –¥–ª—è send)
        'balance' => float,             // –ù–æ–≤—ã–π –±–∞–ª–∞–Ω—Å –ø–æ—Å–ª–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
        'peer_id' => int,               // ID –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞
        'to_user_id' => int,            // DEPRECATED. –£–±–µ—Ä—ë–º –≤ v0.4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ peer_id
        'date' => int,                  // –í—Ä–µ–º—è –æ–ø–µ—Ä–∞—Ü–∏–∏ UNIX-time –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
        'details' => [
            'total' => float,           // –û–±—â–∞—è —Å—É–º–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞, –≤–∫–ª—é—á–∞—è –∫–æ–º–∏—Å—Å–∏—é
            'amount' => float,          // –°–∫–æ–ª—å–∫–æ –µ–¥–∏–Ω–∏—Ü –ø–æ–ª—É—á–∏–ª –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç
            'donate_score' => int,      // –ü–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –æ—á–∫–æ–≤ –¥–æ–Ω–∞—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
            'fee' => float              // –ö–æ–º–∏—Å—Å–∏—è –ø–µ—Ä–µ–≤–æ–¥–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        ],
        'comment' => string,            // –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –ø–µ—Ä–µ–≤–æ–¥—É
        'metadata' => array             // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    ]
]
```

### –ë–∞–ª–∞–Ω—Å (getBalance)

```php
[
    'gold' => float,           // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–¥—ã
    'sweets' => float,         // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ä–∏—Å–æ–∫
    'donate_score' => int      // –î–æ–Ω–∞—Ç –æ—á–∫–∏
]
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π (getUpdates)

```php
[
    [
        'id' => int,                    // ID —Å–æ–±—ã—Ç–∏—è
        'type' => string,               // –¢–∏–ø —Å–æ–±—ã—Ç–∏—è: 'sweets_log' –∏–ª–∏ 'gold_log'
        'date' => int,                  // –í—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è UNIX-time
        'object' => array               // –û–±—ä–µ–∫—Ç —Å–æ–±—ã—Ç–∏—è (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–∫ –≤ history)
    ]
]
```

**–¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π:**
- `sweets_log` - —Å–æ–±—ã—Ç–∏—è —Å –∏—Ä–∏—Å–∫–∞–º–∏ (–æ–±—ä–µ–∫—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏–∑ `pocket/sweets/history`)
- `gold_log` - —Å–æ–±—ã—Ç–∏—è —Å –≥–æ–ª–¥–æ–π (–æ–±—ä–µ–∫—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏–∑ `pocket/gold/history`)

### –ê–≥–µ–Ω—Ç—ã –ò—Ä–∏—Å–∞ (getAgents)

```php
[
    int,  // ID –∞–≥–µ–Ω—Ç–∞ 1
    int,  // ID –∞–≥–µ–Ω—Ç–∞ 2
    int,  // ID –∞–≥–µ–Ω—Ç–∞ 3
    // ... –º–∞—Å—Å–∏–≤ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤
]
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –•—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

- **–¢–æ–∫–µ–Ω—ã –∏ ID** —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `env.example`** –∫–∞–∫ —à–∞–±–ª–æ–Ω –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏


## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ—Å—Ç–æ–π –±–æ—Ç –¥–ª—è –≤—ã–¥–∞—á–∏ –Ω–∞–≥—Ä–∞–¥

```php
<?php
require_once __DIR__ . '/vendor/autoload.php';

use IrisSweetsApi\IrisSweets;
use IrisSweetsApi\Exception\ApiException;

$api = new IrisSweets();

function giveReward($userId, $activity) {
    global $api;
    
    try {
        switch ($activity) {
            case 'daily_login':
                $api->sweets()->give(5, $userId, '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤—Ö–æ–¥');
                $api->gold()->give(10, $userId, '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤—Ö–æ–¥');
                break;
                
            case 'referral':
                $api->sweets()->give(20, $userId, '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥—Ä—É–≥–∞');
                $api->gold()->give(50, $userId, '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥—Ä—É–≥–∞');
                break;
                
            case 'achievement':
                $api->sweets()->give(15, $userId, '–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ');
                $api->gold()->give(25, $userId, '–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ');
                break;
        }
        
        return true;
    } catch (ApiException $e) {
        error_log("–û—à–∏–±–∫–∞ –≤—ã–¥–∞—á–∏ –Ω–∞–≥—Ä–∞–¥—ã: " . $e->getMessage());
        return false;
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
giveReward(123456, 'daily_login');
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–∞–ª–∞–Ω—Å–∞

```php
<?php
require_once __DIR__ . '/vendor/autoload.php';

use IrisSweetsApi\IrisSweets;

$api = new IrisSweets();

function checkBalance() {
    global $api;
    
    try {
        $balance = $api->balance()->getBalance();
        
        echo "=== –ë–∞–ª–∞–Ω—Å –º–µ—à–∫–∞ ===\n";
        echo "–ì–æ–ª–¥–∞: " . $balance['gold'] . "\n";
        echo "–ò—Ä–∏—Å–∫–∏: " . $balance['sweets'] . "\n";
        echo "–î–æ–Ω–∞—Ç –æ—á–∫–∏: " . $balance['donate_score'] . "\n";
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
        if ($balance['gold'] < 100) {
            echo "‚ö†Ô∏è  –í–Ω–∏–º–∞–Ω–∏–µ: –º–∞–ª–æ –≥–æ–ª–¥—ã!\n";
        }
        
        if ($balance['sweets'] < 50) {
            echo "‚ö†Ô∏è  –í–Ω–∏–º–∞–Ω–∏–µ: –º–∞–ª–æ –∏—Ä–∏—Å–æ–∫!\n";
        }
        
    } catch (Exception $e) {
        echo "‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞: " . $e->getMessage() . "\n";
    }
}

checkBalance();
```

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –°–º. —Ñ–∞–π–ª `LICENSE` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

–°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

```bash
git pull origin main
composer update
```
---

**–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ Iris –ß–∞—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä**

